<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Plotting in Python with Matplotlib ‚Äì Various courses</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-ed96de9b727972fe78a7b5d16c58bf87.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-4d9afe2b8d18ee9fa5d0d57b5ed4214d.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-ed96de9b727972fe78a7b5d16c58bf87.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-960d9d362f81d399278ec3e29b622b37.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark-e7f4145358ce1d0cd37d8d374dbb44f9.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../../site_libs/bootstrap/bootstrap-960d9d362f81d399278ec3e29b622b37.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#winter-visualization-series" id="toc-winter-visualization-series" class="nav-link active" data-scroll-target="#winter-visualization-series">Winter visualization series</a></li>
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#backends" id="toc-backends" class="nav-link" data-scroll-target="#backends">Backends</a></li>
  </ul></li>
  <li><a href="#line-plot" id="toc-line-plot" class="nav-link" data-scroll-target="#line-plot">Line plot</a></li>
  <li><a href="#the-global-style" id="toc-the-global-style" class="nav-link" data-scroll-target="#the-global-style">The global style</a>
  <ul class="collapse">
  <li><a href="#runtime-configuration-settings" id="toc-runtime-configuration-settings" class="nav-link" data-scroll-target="#runtime-configuration-settings">Runtime configuration settings</a></li>
  <li><a href="#style-sheets" id="toc-style-sheets" class="nav-link" data-scroll-target="#style-sheets">Style sheets</a></li>
  </ul></li>
  <li><a href="#keyword-arguments" id="toc-keyword-arguments" class="nav-link" data-scroll-target="#keyword-arguments">Keyword arguments</a></li>
  <li><a href="#more-about-figures-and-axes" id="toc-more-about-figures-and-axes" class="nav-link" data-scroll-target="#more-about-figures-and-axes">More about figures and axes</a></li>
  <li><a href="#scatter-plots" id="toc-scatter-plots" class="nav-link" data-scroll-target="#scatter-plots">Scatter plots</a></li>
  <li><a href="#text-and-annotation" id="toc-text-and-annotation" class="nav-link" data-scroll-target="#text-and-annotation">Text and annotation</a></li>
  <li><a href="#more-baic-plot-types" id="toc-more-baic-plot-types" class="nav-link" data-scroll-target="#more-baic-plot-types">More baic plot types</a></li>
  <li><a href="#visualizing-2d-data" id="toc-visualizing-2d-data" class="nav-link" data-scroll-target="#visualizing-2d-data">Visualizing 2D data</a></li>
  <li><a href="#d-plotting" id="toc-d-plotting" class="nav-link" data-scroll-target="#d-plotting">3D plotting</a></li>
  <li><a href="#animations" id="toc-animations" class="nav-link" data-scroll-target="#animations">Animations</a></li>
  <li><a href="#interactivity" id="toc-interactivity" class="nav-link" data-scroll-target="#interactivity">Interactivity</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Plotting in Python with Matplotlib</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="winter-visualization-series" class="level2">
<h2 class="anchored" data-anchor-id="winter-visualization-series">Winter visualization series</h2>
<div style="color: #666; font-family: serif; margin-bottom: 2em">
<p>J. Yohai Meiron, PhD<br> SciNet High Performance Computing Consortium<br> University of Toronto</p>
</div>
<div>
<p><img style="height: 50px; margin-right: 20px" src="https://upload.wikimedia.org/wikipedia/en/b/b5/UofT_logo.svg"> <img style="height: 35px" src="https://scinethpc.ca/wp-content/uploads/scinet-logo.svg"></p>
</div>
<p style="font-size: smaller; color: #999">
The University of Toronto is located on the traditional land of<br>the Huron-Wendat, the Seneca, and the Mississaugas of the Credit.
</p>
<section id="abstract" class="level4">
<h4 class="anchored" data-anchor-id="abstract">Abstract</h4>
<p>Matplotlib is the foundational plotting library for Python, and is widely used in tandem with other scientific libraries (such as NumPy and Pandas) to visualize data across many different fields. It is a free and open source software library that offers fine-grained control over every aspect of a plot, making it a powerful tool for customizing figures to meet specific needs. In this workshop, we will use a Jupyter notebook to show you how to create common 2D plot types such as line, scatter, and heatmaps, and how to customize the labels, legend, and panel layout. We will briefly touch on using Matplotlib to produce animations and interactive visualizations. By the end of this one-hours session, you will have a basic understanding of the library‚Äôs capabilities.</p>
</section>
<section id="how-to-follow" class="level4">
<h4 class="anchored" data-anchor-id="how-to-follow">How to follow?</h4>
<p>Notebook link: https://pages.scinet.utoronto.ca/~ymeiron/matplotlib-demo.ipynb * I‚Äôm using SciNet <a href="https://ondemand.scinet.utoronto.ca">Open OnDemand</a> JupyterLab. Use that if you have access to the Trillium system. * If you don‚Äôt, you can install the <code>notebook</code>, <code>matplotlib</code>, <code>pandas</code> and <code>ipympl</code> Python packages and the <code>ffmpeg</code> software <em>locally</em>, and launch a notebook server. * You can use a free (or paid) cloud Jupyter notebook environment (Google Colab, Binder, Kaggle). Note that not all support interactive plots. * We have a Magic Castle instance for this lecture (details provided separately). This <em>does not</em> support interactive plots however.</p>
<p>Unfortunately we won‚Äôt have time to assist with technical difficulties today.</p>
</section>
</section>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Matplotlib (MPL) is a plotting library for Python, launched in 2003 and inspired by MATLAB. Today we are going to learn the basics of working with it, and I‚Äôm going to demo a few common types of plots, but what we can show in an hour is really the tip of the iceberg in terms of what‚Äôs possible. The best way to learn further is to go to the <a href="https://matplotlib.org/stable/gallery/index.html">gallery</a> and find a figure with features you are interested in, and look at the source code to learn how it was made.</p>
<p>MPL provides a high level API (object-oriented as well as state-based) for creating figures, using several possible backends. This API is called PyPlot, let‚Äôs import it and draw our first figure.</p>
<div id="f8e1befd-157f-4f13-990e-87b5db0e538d" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> pyplot <span class="im">as</span> plt</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="f4895b4c-d03f-47c0-924b-d3e4f2826fde" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The <code>subplots</code> function, called with no parameters here, caused this image to be added to our notebook and returned <code>Figure</code> and <code>Axes</code> objects. The figure is the top level container for all the plot elements. Each visible element, or an object that can draw itself on a figure, is called an <em>artist</em> in MPL terminology (the figure itself is also technically an artist). The axes object (or <em>subfigure</em>) is an artist contained in the figure, and it itself contains other artists (such as the ticks and labels, and plot elements once we add them). Artists have member functions that we can use to manipulate them, as we shall see. Axes are optional but in this lecture we‚Äôll always use them, and we can have more than one set of axes in the figure.</p>
<p><span style="color: LightSkyBlue">üõà</span> This is not the only way to create a figure with axes. In fact, there are usually multiple ways to do anything in Matplotlib, in violation of <a href="https://peps.python.org/pep-0020/#the-zen-of-python">the Zen of Python</a>. Here we‚Äôll stick to an object-oriented coding style and avoid shortcuts. This will produce a code that is slightly longer, but more readable.</p>
<section id="backends" class="level3">
<h3 class="anchored" data-anchor-id="backends">Backends</h3>
<p>Let‚Äôs talk about the figure appearing in the notebook. While this was just one line, obviously there is a lot of low level <em>backend</em> code that‚Äôs involved here. MPL can use several different backends to actually create an image (be it static or interactive). We don‚Äôt need to know much about what they do and how, but just that we have the choice.</p>
<section id="jupyter-notebooks" class="level4">
<h4 class="anchored" data-anchor-id="jupyter-notebooks">Jupyter notebooks</h4>
<p>The default backend in Jupyter notebooks is called <code>inline</code>. It essentially creates a PNG image (a static bitmap) from the figure, that is embedded into the notebook web page. Here, we cannot interact with the plot.</p>
<p>An alternative backend for Jupyter Notebooks is <code>ipympl</code> (requires a package of the same name to be installed). It renders the figure as an applet using web technologies (such as JavaScript) that get embedded in the notebook web page. Here, we can interact with the figure using the mouse as we are going to see. To switch to this backend use the <code>%matplotlib ipympl</code> Jupyter ‚Äúmagic‚Äù command.</p>
<p><span style="color: LightSkyBlue">üõà</span> In a notebook, if we create a figure in one cell, the <code>Figure</code> object still exists in the following cells (until it‚Äôs discarded, e.g.&nbsp;the <code>fig</code> name reassigned). If it (or subordinate artists) is manipulated in the following cells, this will only affect what we see embedded in the notebook if we are using the <code>ipympl</code> backend. If the <code>inline</code> backend is used, commands run in the following cells won‚Äôt affect the already-displayed figure. In this case you can draw the figure again using <code>display(fig)</code>.</p>
<div id="99c383de-b3b1-4f28-9f5c-a026894937d7" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib ipympl</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Run this cell and go back to the cell where we created the previous figure, and run it again.</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="interactive-backends-and-the-show-function" class="level4">
<h4 class="anchored" data-anchor-id="interactive-backends-and-the-show-function">Interactive backends and the <code>show</code> function</h4>
<p>If the Python code runs as a standalone program through the command line, you‚Äôll usually use a backend that renders the figure in a graphical window. The backend will normally be chosen automatically based on the operating system and Python/MPL installation, but can be changed using the <code>matplotlib.use</code> function.</p>
<p><strong>Importantly</strong>, when all figures are ready, use <code>plt.show()</code> to indicate to the backend to open the graphical windows (one per figure).</p>
</section>
<section id="static-backends-and-the-savefig-function" class="level4">
<h4 class="anchored" data-anchor-id="static-backends-and-the-savefig-function">Static backends and the <code>savefig</code> function</h4>
<p>If the Python code runs in a non-interactive environment, such as when running a batch job in an HPC cluster, you‚Äôll use a <em>static</em> backend, that will not attempt to render anything to the screen. In most cases the library will know that there is no display available, but if MPL is trying to use an interactive backend for some reason and is producing an error, you can change it by using the <code>matplotlib.use</code> function (and choosing a static backend such as <code>agg</code>).</p>
<p>In those cases, you will save a figure to a file. The static backend will be chosen automatically based on the file extension. For example:</p>
<div id="1eefd783-61d1-4e99-8a53-b0d93df70ece" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>fig.savefig(<span class="st">'simple_figure.pdf'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
</section>
</section>
<section id="line-plot" class="level2">
<h2 class="anchored" data-anchor-id="line-plot">Line plot</h2>
<p>Let‚Äôs create our first <em>plot</em>.</p>
<div id="a83ff3c6-ad0c-4a04-8ec2-54a9303e5b6c" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>x  <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">16</span>, <span class="dv">256</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>y1 <span class="op">=</span> np.sin(x)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>y2 <span class="op">=</span> np.cos(x)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>ax.plot(x, y1, label<span class="op">=</span><span class="st">'sine'</span>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>ax.plot(x, y2, label<span class="op">=</span><span class="st">'cosine'</span>)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>ax.legend()</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'x'</span>)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'y'</span>)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Trigonometric functions'</span>)<span class="op">;</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co"># The semicolon at the end of the last command just suppresses some unwanted output in the Jupyter notebook</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><span style="color: LightSkyBlue">üõà</span> The alternative to this object-oriented approach is to use the <code>plt.plot</code> function, which creates the figure and axes if they don‚Äôt already exist.</p>
</section>
<section id="the-global-style" class="level2">
<h2 class="anchored" data-anchor-id="the-global-style">The global style</h2>
<p>As we just saw, sensible defaults are used when creating a new figure. We didn‚Äôt have to specify what font to use, what colour to use for each line, where to place the ticks, etc. In this case we just used MPL‚Äôs defaults, giving us this signature look.</p>
<section id="runtime-configuration-settings" class="level3">
<h3 class="anchored" data-anchor-id="runtime-configuration-settings">Runtime configuration settings</h3>
<p>When producing many figures (e.g.&nbsp;for publication, or a poster), we might want to tweak these defaults, so our figures have a consistent look. To do this we can tweak the runtime configuration settings by manipulating <code>matplotlib.rcParams</code>. For example:</p>
<div id="9911c27c-3de5-4075-824f-bad93f784c59" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib <span class="im">as</span> mpl</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>mpl.rcParams[<span class="st">'font.family'</span>] <span class="op">=</span> <span class="st">'Futura LT'</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Run this cell and go back to the cell where we created the previous figure, and run it again.</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Will change the default font of artists (reminder: this means figure elements) to Futura, in all future figures in this notebook.</p>
<p>There are (currently) 322 different settings (not all style-related)! So MPL plots are extremely customizable. You can find them listed <a href="https://matplotlib.org/stable/api/matplotlib_configuration_api.html#matplotlib.rcParams">here</a>.</p>
<p>‚ö†Ô∏è When choosing a font, it has to be installed on the machine where the Python interpreter (for the Jupyter notebook in this case) is running.</p>
</section>
<section id="style-sheets" class="level3">
<h3 class="anchored" data-anchor-id="style-sheets">Style sheets</h3>
<p>In addition to MPL‚Äôs ‚Äúsignature‚Äù look, additional pre-defined styles are available (see them listed <a href="https://matplotlib.org/stable/gallery/style_sheets/style_sheets_reference.html">here</a>). Load them with <code>plt.style.use</code> (and of course, you can still tweak the chosen style by manipulating <code>matplotlib.rcParams</code>)</p>
<div id="065fc953-9941-4bcd-9b00-007dd55123af" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>plt.style.use(<span class="st">'classic'</span>) <span class="co"># Also try: ggplot, fivethirtyeight, bmh</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Run this cell and go back to the cell where we created the previous figure, and run it again.</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="5b142150-b24f-4f3e-a893-97f363f24d4f" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Restore defaults values of all runtime configuration settings</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>plt.rcdefaults()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
</section>
<section id="keyword-arguments" class="level2">
<h2 class="anchored" data-anchor-id="keyword-arguments">Keyword arguments</h2>
<p>The most common way to customize part of the figure is to pass keyword arguments to the function that creates the artist. In the line plot example, the first line was blue and the second orange, this colour sequence is defined in the default style sheet. We can manipulate the line‚Äôs characteristics by passing suitable keywords that the <code>plot</code> function can accept (see <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.plot.html">documentations</a>).</p>
<div id="4281f373-6cb8-4309-a4e2-d76dfb04efd0" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>l, <span class="op">=</span> ax.plot(x, y1, color<span class="op">=</span><span class="st">'r'</span>, linewidth<span class="op">=</span><span class="dv">4</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<ul>
<li>The string <code>r</code> is a single character shorthand notation for ‚Äúred‚Äù, there are <a href="https://matplotlib.org/stable/users/explain/colors/colors.html">many other ways</a> to specify colours.</li>
<li>The string <code>--</code> indicates a dashed line, see other options <a href="https://matplotlib.org/stable/gallery/lines_bars_and_markers/linestyles.html">here</a>.</li>
<li>Capturing the output (artist) of <code>ax.plot</code> is not mandatory and not needed in most cases, but if we have it we can manipulate it (the line style <strong>or even the data</strong>) in the future (useful for animations!) For example:</li>
</ul>
<div id="15b758e1-4dde-45da-b2ff-1572dd8a0be9" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>l.set_linewidth(<span class="fl">0.5</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="ca015d4c-c84f-44cc-b14f-9dc57c2f235c" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>l.set_ydata(np.sin(<span class="dv">4</span><span class="op">*</span>x))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<ul>
<li>Some keywords have aliases: <code>color</code> ‚Üí <code>c</code>, <code>linewidth</code> ‚Üí <code>lw</code>, <code>linestyle</code> ‚Üí <code>ls</code></li>
<li>The <code>plot</code> function also supports a third positional argument (after <code>x</code> and <code>y</code>) that can be used to specify colour and line style (as well as marker style), so the above is equivalent to <code>ax.plot(x, y1, 'r--', linewidth=4)</code>.</li>
</ul>
</section>
<section id="more-about-figures-and-axes" class="level2">
<h2 class="anchored" data-anchor-id="more-about-figures-and-axes">More about figures and axes</h2>
<p>Let‚Äôs create a figure with two sets of axes one on top of the other. We‚Äôll make the same line plot in both.</p>
<div id="6359214e-161f-4cf4-bb08-fa00b7410465" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>fig, [ax1, ax2] <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">2</span>, figsize<span class="op">=</span>(<span class="fl">6.4</span>, <span class="fl">6.4</span>))</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>func <span class="op">=</span> <span class="kw">lambda</span> x: np.exp(x)<span class="op">/</span>(np.sin(<span class="dv">2</span><span class="op">*</span>x)<span class="op">+</span><span class="dv">2</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>ax1.plot(x, func(x))</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>ax2.plot(x, func(x))<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<ul>
<li>We used keyword arguments for <code>plt.subplots</code> to make two sets of axes in one column, and also change the figure size.</li>
<li>The <code>figsize</code> keyword argument takes a tuple of width and height in the Imperial ‚Äúinch‚Äù unit (2.54 cm). The default figure size is 6.4 √ó 4.8 of those units (<code>rcParams['figure.figsize']</code>), and the on-screen resolution is 100 pixels per ‚Äúinch‚Äù (<code>rcParams['figure.dpi']</code>).</li>
<li>We drew two independent sets of axes. We can lock the x-axis by adding <code>sharex=True</code> to <code>plt.subplots</code>.</li>
<li>Of course, we can have bigger grids of subplots, and even more elaborate arrangements by using <a href="https://matplotlib.org/stable/gallery/subplots_axes_and_figures/gridspec_multicolumn.html">GridSpec</a>.</li>
</ul>
<p>This plot isn‚Äôt very good because of the large range of y-values. Let‚Äôs change the lower subplot such that the y-axis is logarithmic:</p>
<div id="8e717429-f263-470f-9d27-8cf484e5a153" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>ax2.set_yscale(<span class="st">'log'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>By default, MPL leaves some margins around the data for determining axis limits (cf.&nbsp;<code>rcParams['axes.xmargin']</code>).</p>
<p>We can manually set the limits to whatever we want like so:</p>
<div id="725b84ef-d3dd-421d-9cd9-7918d9b7b167" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>ax2.set_xlim(<span class="dv">0</span>, <span class="dv">10</span>)<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<ul>
<li>If the x-axis is shared (<code>sharex=True</code>) then whatever limits we set for <code>ax2</code> will apply to <code>ax1</code> as well (and vice versa)!</li>
<li><code>Axes</code> has convenience functions to create a line plot <em>and</em> simultaneously change the scaling to logarithmic, these are <code>semilogx</code>, <code>semilogy</code>, and <code>loglog</code>.</li>
</ul>
<p>If we want to change the spacing between the subplots, we can call <code>Figure.subplots_adjust</code> (cf.&nbsp;<code>Figure.tight_layout</code>)</p>
<div id="d6fddea6-2bff-487f-80f3-e3c7c2476939" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>fig.subplots_adjust(hspace<span class="op">=</span><span class="fl">0.025</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="scatter-plots" class="level2">
<h2 class="anchored" data-anchor-id="scatter-plots">Scatter plots</h2>
<p>We can use <code>plt.plot</code> for simple scatter plots as well. We just have to make sure that there are markers but no line.</p>
<div id="07401111-f883-47df-9eea-9c09227d62fd" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>x_peaks <span class="op">=</span> np.arctan(<span class="op">-</span><span class="dv">1</span><span class="op">/</span><span class="dv">2</span>) <span class="op">+</span> np.arange(<span class="dv">1</span>, <span class="dv">6</span>)<span class="op">*</span>np.pi</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>ax2.plot(x_peaks, func(x_peaks), linestyle<span class="op">=</span><span class="st">''</span>, marker<span class="op">=</span><span class="st">'o'</span>)<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<ul>
<li>There are quite a few markers to choose from (and you can make your own), see <a href="https://matplotlib.org/stable/gallery/lines_bars_and_markers/marker_reference.html">here</a>.</li>
<li>We could have created an equivalent plot with the third positional argument: <code>ax2.plot(x_peaks, func(x_peaks), 'o')</code></li>
</ul>
<p>The <code>Axes</code> class has many more plotting functions! While <code>plot</code> can create a scatter plot, all markers have the same shape, size, and colour. We can use <code>scatter</code> instead if we want to represent additional properties visually. In the example below we use Pandas to retrieve a small dataset related to penguins, and create a scatter plot of bill length vs.&nbsp;flipper length, where the colour represents a third property (body mass).</p>
<div id="47bb2323-13c5-4eab-be2c-8fd2da4d7063" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'https://raw.githubusercontent.com/allisonhorst/palmerpenguins/master/inst/extdata/penguins.csv'</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>display(df)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> df[<span class="st">'flipper_length_mm'</span>]</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df[<span class="st">'bill_length_mm'</span>]</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>prop <span class="op">=</span> df[<span class="st">'body_mass_g'</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="c7543cfe-f0b9-4089-8daf-6f316e169926" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>scatter_plot <span class="op">=</span> ax.scatter(x, y, c<span class="op">=</span>prop)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Flipper length [mm]'</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Bill length [mm]'</span>)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>fig.colorbar(scatter_plot, label<span class="op">=</span><span class="st">'Body mass [g]'</span>)<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<ul>
<li>This colour map is called <em>viridis</em> and is the default because it works well when printed in greyscale and is colourblind-friendly (‚Äúmonotonic luminance‚Äù). It is also relatively perceptually uniform.</li>
<li>There are many more <a href="https://matplotlib.org/stable/users/explain/colors/colormaps.html">options</a>, and you can make your own.
<ul>
<li>Try passing <code>cmap='jet'</code> to <code>scatter</code>.</li>
</ul></li>
<li>Instead of the <code>c</code> keyword argument, try using <code>s</code> to have the marker size represent the property
<ul>
<li>‚ö†Ô∏è You will usually have to transform the property somehow to get a useful visualization.</li>
</ul></li>
</ul>
</section>
<section id="text-and-annotation" class="level2">
<h2 class="anchored" data-anchor-id="text-and-annotation">Text and annotation</h2>
<p>We can place a text anywhere within the axes by calling the <code>text</code> function of the object (and there is also a <code>Figure.text</code> to place text in the figure, not associated with one axes/subplot object or another). In the example below we used <code>Axes.annotate</code> that is a bit more feature rich: it can place the text, but also shift it with respect to the point of interest, and draw and arrow to it.</p>
<div id="6904b6bc-30eb-4356-96b2-3992e2ff79f3" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>i_maxmass <span class="op">=</span> np.argmax(prop)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>x_maxmass, y_maxmass <span class="op">=</span> x[i_maxmass], y[i_maxmass]</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>ax.annotate(</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    <span class="ss">f'chonkiest</span><span class="ch">\n</span><span class="ss">penguin</span><span class="ch">\n</span><span class="ss">(</span><span class="sc">{</span><span class="fl">0.001</span><span class="op">*</span>prop[i_maxmass]<span class="sc">}</span><span class="ss"> kg)'</span>, <span class="co"># What text to place</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    (x_maxmass, y_maxmass), <span class="co"># What point to annotate</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    xytext<span class="op">=</span>(<span class="dv">15</span>, <span class="op">-</span><span class="dv">80</span>), textcoords<span class="op">=</span><span class="st">'offset points'</span>, <span class="co"># Where to put the annotation</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    arrowprops<span class="op">=</span><span class="bu">dict</span>(arrowstyle<span class="op">=</span><span class="st">'-&gt;'</span>), <span class="co"># Arrow properties</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    bbox<span class="op">=</span><span class="bu">dict</span>(boxstyle<span class="op">=</span><span class="st">'round'</span>, facecolor<span class="op">=</span><span class="st">'w'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>), <span class="co"># Box properties</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    horizontalalignment<span class="op">=</span><span class="st">'center'</span> <span class="co"># Other text properties</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>)<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="more-baic-plot-types" class="level2">
<h2 class="anchored" data-anchor-id="more-baic-plot-types">More baic plot types</h2>
<div id="8c65243c-f582-4907-a275-3d1d7a8ecbc5" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">10</span>, <span class="fl">0.5</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>noise_envelope <span class="op">=</span> np.sqrt((x<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">10</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">3</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>noise <span class="op">=</span> np.random.randn(<span class="bu">len</span>(x))<span class="op">*</span>noise_envelope</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.cos(x) <span class="op">+</span> noise</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>fig, axs <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">3</span>, figsize<span class="op">=</span>(<span class="fl">6.4</span>, <span class="fl">6.4</span>), sharex<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].errorbar(x, y, yerr<span class="op">=</span>noise_envelope, linestyle<span class="op">=</span><span class="st">''</span>, marker<span class="op">=</span><span class="st">'o'</span>, capsize<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].set_title(<span class="st">'Errorbar'</span>, y<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].step(x, y)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].set_title(<span class="st">'Step'</span>, y<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">2</span>].bar(x, y, width<span class="op">=</span><span class="fl">0.25</span>)</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">2</span>].set_title(<span class="st">'Bar'</span>, y<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].set_xlim(x[<span class="dv">0</span>], x[<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">'More basic plot types'</span>)</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>fig.subplots_adjust(hspace<span class="op">=</span><span class="fl">0.05</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><span style="color: LightSkyBlue">üõà</span> A useful convenience function is <code>Axes.hist</code>, which calculates a histogram from a dataset and draws a bar (or step) plot. Generally speaking, MPL is not a package for data analysis or numerical calculations, but it does have a few convenience functions for statistics and spectral analysis.</p>
<p><strong>Seaborn</strong> is another library that uses MPL for data visualization. It provides a (even) higher-level API, that does both data analysis and plotting with fewer lines of code compared to MPL (check out Jarno‚Äôs talk next week).</p>
</section>
<section id="visualizing-2d-data" class="level2">
<h2 class="anchored" data-anchor-id="visualizing-2d-data">Visualizing 2D data</h2>
<p>The simplest way to visualize the values of a 2D array is by using the <code>Axes.imshow</code> function, assuming a regular grid. This function treats the array values as image pixels, and maps it into the axes based on the <code>extent</code> argument.</p>
<div id="5faf9121-eec1-4699-9ab7-e2930cb1387f" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>x_ <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">64</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>y_ <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">64</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>x, y <span class="op">=</span> np.meshgrid(x_, y_)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>z <span class="op">=</span> <span class="dv">3</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x)<span class="op">**</span><span class="dv">2</span><span class="op">*</span>np.exp(<span class="op">-</span>x<span class="op">**</span><span class="dv">2</span><span class="op">-</span>(y<span class="op">+</span><span class="dv">1</span>)<span class="op">**</span><span class="dv">2</span>) <span class="op">-</span> <span class="dv">10</span><span class="op">*</span>(x<span class="op">/</span><span class="dv">5</span><span class="op">-</span>x<span class="op">**</span><span class="dv">3</span><span class="op">-</span>y<span class="op">**</span><span class="dv">5</span>)<span class="op">*</span>np.exp(<span class="op">-</span>x<span class="op">**</span><span class="dv">2</span><span class="op">-</span>y<span class="op">**</span><span class="dv">2</span>) <span class="op">-</span> (<span class="dv">1</span><span class="op">/</span><span class="dv">3</span>)<span class="op">*</span>np.exp(<span class="op">-</span>(x<span class="op">+</span><span class="dv">1</span>)<span class="op">**</span><span class="dv">2</span><span class="op">-</span>y<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>im <span class="op">=</span> ax.imshow(z, origin<span class="op">=</span><span class="st">'lower'</span>, extent<span class="op">=</span>[<span class="op">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="op">-</span><span class="dv">3</span>, <span class="dv">3</span>])</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>fig.colorbar(im)</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'x'</span>)</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'y'</span>)<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Like with <code>scatter</code>, you can choose a different colour map by passing the <code>cmap</code> parameter.</p>
<p>If the array is 3-dimensional, and the third dimension is size 3 or 4, this will be interpreted as a colour image (RGB or RGBA) and displayed accordingly.</p>
<p>‚ö†Ô∏è <code>Axes.imshow</code> will show the array upside-down by default (with respect to how NumPy arrays are interpreted), use <code>origin='lower'</code> to change this behaviour.</p>
<p>An alternative to <code>imshow</code> is <code>pcolormesh</code>, that supports non-uniform grids and have a syntax that‚Äôs more similar to the basic plotting functions. However it is slower and may produce very large output files if a vector graphics format is used (such as PDF or SVG).</p>
<p>You can also use <code>contour</code> or <code>contourf</code>:</p>
<div id="6f40709c-809f-4144-b9d0-cf2c177185a4" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>contour <span class="op">=</span> ax.contour(x, y, z, levels<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>ax.clabel(contour)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'x'</span>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'y'</span>)<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>This plot looks squashed because by default it‚Äôs adjusted to the size of the axes. We can force the aspect ratio like so:</p>
<div id="196ba073-91fe-4c63-865e-e7971b19ac95" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>ax.set_aspect(<span class="st">'equal'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="d-plotting" class="level2">
<h2 class="anchored" data-anchor-id="d-plotting">3D plotting</h2>
<p>Matplotlib can make basic and even reasonably advanced <a href="https://matplotlib.org/stable/gallery/mplot3d/index.html">3D plots</a> (surfaces, wireframes, scatter, bars, etc.) It is not a full 3D rendering engine and lacks many features such as complex lighting and shadows, volumetric rendering, and advanced camera controls. Additionally it is not hardware accelerated, so will not handle large datasets as well as specialized tools.</p>
<p>Here is a demonstration of plotting the 2D array from before as a surface:</p>
<div id="044ce59b-77f4-4661-a02d-d505ebb68b2a" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure()</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> fig.add_subplot(projection<span class="op">=</span><span class="st">'3d'</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>ax.plot_surface(x, y, z)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'x'</span>)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'y'</span>)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>ax.set_zlabel(<span class="st">'z'</span>)<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="animations" class="level2">
<h2 class="anchored" data-anchor-id="animations">Animations</h2>
<p>An animation is just a sequence of still frames. As we saw throughout this lecture, once an artist is created, we can use various functions to modify it. The MPL <em>animation</em> module provides a useful class called <code>FuncAnimation</code>: you need to pass to it a function that updates the plot as a side effect, and the resultant <code>Animation</code> object can be saved or displayed on screen. Here is an example:</p>
<div id="59012af2-78d2-459d-b899-7e468bcf045d" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.animation <span class="im">as</span> animation</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>frames <span class="op">=</span> <span class="dv">60</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">16</span>, <span class="dv">256</span>)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">2</span><span class="op">*</span>np.pi, frames<span class="op">+</span><span class="dv">1</span>)[:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>y1 <span class="op">=</span> np.sin(x)<span class="op">*</span>np.sin(t[<span class="dv">0</span>])</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>y2 <span class="op">=</span> np.cos(x)<span class="op">*</span>np.cos(t[<span class="dv">0</span>])</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>l1, <span class="op">=</span> ax.plot(x, y1, label<span class="op">=</span><span class="st">'sine'</span>)</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>l2, <span class="op">=</span> ax.plot(x, y2, label<span class="op">=</span><span class="st">'cosine'</span>)</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>ax.legend(loc<span class="op">=</span><span class="st">'upper left'</span>)</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'x'</span>)</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'y'</span>)</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Trigonometric functions'</span>)</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>text <span class="op">=</span> ax.text(<span class="dv">0</span>,  <span class="fl">0.65</span>, <span class="st">'t = 0.00'</span>, bbox<span class="op">=</span><span class="bu">dict</span>(boxstyle<span class="op">=</span><span class="st">'round'</span>, facecolor<span class="op">=</span><span class="st">'w'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>), fontfamily<span class="op">=</span><span class="st">'monospace'</span>)</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> update(frame):</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>    y1 <span class="op">=</span> np.sin(x)<span class="op">*</span>np.sin(t[frame])</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>    y2 <span class="op">=</span> np.cos(x)<span class="op">*</span>np.cos(t[frame])</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>    l1.set_ydata(y1)</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>    l2.set_ydata(y2)</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>    text.set_text(<span class="ss">f't = </span><span class="sc">{</span>t[frame]<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>ani <span class="op">=</span> animation.FuncAnimation(fig<span class="op">=</span>fig, func<span class="op">=</span>update, frames<span class="op">=</span>frames, interval<span class="op">=</span><span class="dv">3000</span><span class="op">/</span>frames)</span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Show animation in notebook</span></span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>plt.close(fig)</span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> HTML</span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>HTML(ani.to_html5_video())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<ul>
<li>We created a figure much like we did before; we added two line plots, a legend, and a text.</li>
<li>Notice we passed <code>loc='upper left'</code> to <code>legend</code> (otherwise it will jump around in the animation depending on the line plots).</li>
<li>The <code>update</code> function recalculates the y values for both plots.
<ul>
<li>It updates the plot (<code>Line2D</code>) artists.</li>
<li>It updates the text (<code>Text</code>) artist.</li>
</ul></li>
<li>There are several other ways to embed an animation in a notebook, this one works quite well.
<ul>
<li>We closed the figure with <code>plt.close</code> so the static figure doesn‚Äôt show up in addition to the animation.</li>
<li>Beware of very large animations in a Jupyter notebook, you might want to just save to a file with <code>Animation.save</code>.</li>
</ul></li>
</ul>
</section>
<section id="interactivity" class="level2">
<h2 class="anchored" data-anchor-id="interactivity">Interactivity</h2>
<p>In addition to the built-in interactive capabilities of the axes object, you can add <a href="https://matplotlib.org/stable/gallery/widgets/index.html">widgets</a> such as buttons and sliders, capture events in the Python code and update the plot as needed.</p>
<p>This probably shouldn‚Äôt be your first choice to develop a UI for an application, but can be useful to interactively adjust parameters. The example below adds a button to the figure, clicking it calls the <code>update</code> function that, like before, changes the existing artists.</p>
<div id="c04a3ee3-2c18-4144-aa43-b68851401518" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.widgets <span class="im">import</span> Slider</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>fig.subplots_adjust(bottom<span class="op">=</span><span class="fl">0.2</span>)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">16</span>, <span class="dv">256</span>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.sin(x)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>l, <span class="op">=</span> ax.plot(x, y, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="vs">r'</span><span class="dv">$\s</span><span class="vs">in</span><span class="kw">(</span><span class="er">\</span><span class="vs">omega x</span><span class="kw">)</span><span class="dv">$</span><span class="vs">'</span>)</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'x'</span>)</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'y'</span>)</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> update(value):</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> np.sin(x<span class="op">*</span>value)</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>    l.set_ydata(y)</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>ax_slider <span class="op">=</span> fig.add_axes([<span class="fl">0.3</span>, <span class="fl">0.05</span>, <span class="fl">0.4</span>, <span class="fl">0.025</span>])</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>slider <span class="op">=</span> Slider(ax_slider, <span class="vs">r'</span><span class="dv">$</span><span class="er">\</span><span class="vs">omega</span><span class="dv">$</span><span class="vs">'</span>, <span class="fl">0.5</span>, <span class="dv">3</span>, valinit<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>slider.on_changed(update)<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "Óßã";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/folio\.vastcloud\.org");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>